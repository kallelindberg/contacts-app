<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>3K00d1</title>

    <link rel="stylesheet" type="text/css" href="styles.css"/>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>

</head>
<body onload="load()">
<div>
    <table class="adjustment-table"><br>
    <tr><th valign="top">
    <a id="header" class="title">Contact List</a>
    <table class="mdl-data-table mdl-js-data-table">
    <tr>
        <th>First Name</th><th><input name="FirstName" type="text" maxlength="512" id="fName" class="searchField"/></th>
    </tr>
    <tr>
        <th>Last Name</th><th><input name="LastName" type="text" maxlength="512" id="lName" class="searchField"/></th>
    </tr>
    <tr>
        <th>Age</th><th><input name="Age" type="text" maxlength="512" id="age" class="searchField"/></th>
    </tr>
    <tr>
        <th>Address</th><th><input name="Address" type="text" maxlength="512" id="address" class="searchField"/></th>
    </tr>
    <tr>
        <th></th><th><input type="button" class="mdl-button mdl-button--raised" id="button" value="Add" ></th>
    </tr>
</table>
    </th>

<th valign="top">
<a id="text" class="text">Contacts</a>
<table id="table" class="mdl-data-table mdl-js-data-table">
    <tr>
        <th>Firstname</th>
        <th>Lastname</th>
        <th>Age</th>
        <th>Address</th>
        <th><button id="deleteList" class="mdl-button mdl-button--raised" onclick="deleteList()">delete list</button></th>
    </tr>
</table>
</th></tr></table>
</div>

<script>

    var entry, list = [];
    var initTable = document.getElementById("table").innerHTML;

    function load(){
        document.getElementById("button").setAttribute('onclick', "onButtonClick()");
        if (localStorage.getItem('list') != null && localStorage.getItem('list') !=""){
            var object = localStorage.getItem("list");
            list = JSON.parse(object);
            fillTable(list);
        }
    }

    function onButtonClick() {

        var firstName = document.getElementById("fName").value;
        var lastName = document.getElementById("lName").value;
        var age = document.getElementById("age").value;
        var address = document.getElementById("address").value;
        entry = [firstName, lastName, age, address];
        list.push(entry);
        storeList(list);
        fillTable(list);
        initFields();
    }

    function fillTable(object){
        var table = document.getElementById("table");
        table.innerHTML = initTable;
        for (var c =0; c < object.length; c++){
            var row = table.insertRow(c+1);
            for (var i = 0; i < object[c].length; i++) {
                row.insertCell(i).innerHTML = object[c][i];
            }
            row.insertCell(4).innerHTML = '<input name="edit" type="button" class="mdl-button mdl-button--raised" value="edit" onClick="Javascript:editContact(this)"><input type="button" name ="delete" class="mdl-button mdl-button--raised" value="del" onClick="Javascript:deleteContact(this)">';
        }
    }
    function storeList(object){
        localStorage.setItem("list", JSON.stringify(object));
    }
    function deleteList(){
        localStorage.clear();
        list = [];
        document.getElementById("table").innerHTML = initTable;
    }

    function deleteContact(object){
        var table = document.getElementById("table");
        var index = object.parentNode.parentNode.rowIndex;
        table.deleteRow(index);
        list.splice(index-1, 1);
        storeList(list);
    }

    function editContact(object){
        var table = document.getElementById("table");
        var index = object.parentNode.parentNode.rowIndex -1;
        var holder = "submitEdit("+index+")";
        document.getElementById("fName").value = list[index][0];
        document.getElementById("lName").value = list[index][1];
        document.getElementById("age").value = list[index][2];
        document.getElementById("address").value = list[index][3];
        document.getElementById("button").value = "Submit";
        document.getElementById("button").setAttribute('onclick', holder);
        document.getElementById("deleteList").disabled = "true";
        var disAbListE = document.getElementsByName("edit");
        for(var i = 0; i < disAbListE.length; i++) {
            disAbListE[i].disabled = true;
        }
        var disAbListD = document.getElementsByName("delete");
        for(var i = 0; i < disAbListD.length; i++) {
            disAbListD[i].disabled = true;
        }

    }
    function submitEdit(object){
        var firstName = document.getElementById("fName").value;
        var lastName = document.getElementById("lName").value;
        var age = document.getElementById("age").value;
        var address = document.getElementById("address").value;

        document.getElementById("fName").value = list[object][0];
        document.getElementById("lName").value = list[object][1];
        document.getElementById("age").value = list[object][2];
        document.getElementById("address").value = list[object][3];
        document.getElementById("button").setAttribute('onclick', "onButtonClick()");
        entry = [firstName, lastName, age, address];
        list[object]=entry;
        storeList(list);
        fillTable(list);
        initFields();
    }
    function initFields(){
        document.getElementById("fName").value = "";
        document.getElementById("lName").value = "";
        document.getElementById("age").value = "";
        document.getElementById("address").value = "";
        document.getElementById("button").value = "Add";
    }

</script>
</body>
</html>